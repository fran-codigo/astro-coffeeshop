---
import MenuItem from "@/components/menu/MenuItem.astro";
import { MenuItemsSchema } from "@/types";

const url = `${import.meta.env.API_URL}/products?product_categories=7`;
const res = await fetch(url);
const json = await res.json();
const data = MenuItemsSchema.parse(json);
---

<div class="">
  <h4 class="text-white font-black text-4xl uppercase text-center my-10">
    Comida
  </h4>

  <ul id="food-menu" class="spacey-3">
    {
      data.map((item) => (
        <MenuItem
          title={item.title.rendered}
          description={item.acf.description}
          price={item.acf.price}
          image={item.featured_images}
        />
      ))
    }
  </ul>
</div>

<script>
  import PhotoSwipeLightbox from "photoswipe/lightbox";
  import "photoswipe/style.css";

  const lightbox = new PhotoSwipeLightbox({
    gallery: "#food-menu",
    children: "a",
    pswpModule: () => import("photoswipe"),
  });
  lightbox.init();

  document.addEventListener("astro:after-swap", () => {
    lightbox.init();
  });
</script>
